<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Document</title>
		<style>
			.red {
				color: red;
			}
			.green {
				color: green;
			}
		</style>
		<script src="https://cdn.jsdelivr.net/npm/vue@3.2.47/dist/vue.global.min.js"></script>
	</head>
	<body>
		<!-- 挂载点 -->
		<div id="root"></div>
	</body>
	<script>
		// 创建 Vue 实例
		const app = Vue.createApp({
			// 局部注册
			components: {},
			// 数据
			data() {
				return {
					message: 'hello world!',
					count: 1,
				};
			},
			// 侦听器
			watch: {},
			// 计算属性
			computed: {},
			// 方法
			methods: {
				handleClick(msg) {
					this.count += 1;
					alert('监听到子组件：' + msg);
				},
			},
			// 根组件
			template: `
				<div>
					{{message}}
                    {{count}}

					<p>通过触发父组件的事件来修改父组件发送数据</p>
					<demo :content="count" @handleAddOne="handleClick"/>
					<demo :content="count" @handle-add-one="handleClick"/>

                    <p>通过 v-model 实现数据的双向绑定</p>
                    <test v-model:value="count" />
				</div>
			`,
		});

		app.component('demo', {
			props: ['content'],
			// 处理向外触发的事件
			emits: {
				handleAddOne: (parm) => {
					// 校验
					return typeof parm === 'string' ? true : false;
				},
			},
			methods: {
				// $emit 是一个实例方法，用于触发当前实例上的自定义事件
				handleItemClick() {
					// 它接收两个参数：事件名称和要传递的数据
					const msg = '347';
					// console.log(typeof msg === 'string');
					this.$emit('handleAddOne', msg); // 触发驼峰，监听横线
				},
			},
			template: `
				<div @click="handleItemClick">{{content}}</div>
			`,
		});

		/**
		 * modelValue 是一个 prop，用于在组件中传递数据。
		 * 它通常用于表单组件，例如输入框、单选框、复选框等，用于绑定表单元素的值。
		 * 当用户在表单元素中输入或选择内容时，modelValue 的值会随之改变，从而实现数据的双向绑定。
		 * 在组件内部，可以通过 $emit 方法触发一个名为 update:modelValue 的事件，从而更新父组件中的数据。
		 **/
		app.component('test', {
			// props: ['modelValue'],
			props: ['value'],
			methods: {
				handleItemClick() {
					// this.$emit('update:modelValue', this.modelValue + 1);
					this.$emit('update:value', this.value + 2);
				},
			},
			template: `
                <div @click="handleItemClick">{{value}}</div>
			`,
		});

		const vm = app.mount('#root');
	</script>
</html>
